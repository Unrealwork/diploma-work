% Тут используется класс, установленный на сервере Papeeria. На случай, если
% текст понадобится редактировать где-то в другом месте, рядом лежит файл matmex-diploma-custom.cls
% который в момент своего создания был идентичен классу, установленному на сервере.
% Для того, чтобы им воспользоваться, замените matmex-diploma на matmex-diploma-custom
% Если вы работаете исключительно в Papeeria то мы настоятельно рекомендуем пользоваться
% классом matmex-diploma, поскольку он будет автоматически обновляться по мере внесения корректив
%
\documentclass{matmex-diploma-custom}

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{hyperref}

\usepackage{listings}
\lstset{language=Java, captionpos=b, basicstyle=\footnotesize, breakatwhitespace=true, breaklines=true}
\renewcommand{\lstlistingname}{Код программы}

\begin{document}
\filltitle{ru}{
    chair              = {Кафедра Исследования Операций},
    title              = {Оконное преобразование Уолша},
    type               = {diploma},
    position           = {студента},
    group              = 523,
    author             = {Калабин Григорий Александрович},
    supervisorPosition = {к.\,ф.-м.\,н., доцент},
    supervisor         = {{\sigplace{С.М.~Машарский}{подпись}}},
    reviewerPosition   = {д.\,ф.-м.\,н., профессор},
    reviewer           = {{\sigplace{В.Н.~Малозёмов}{подпись}}},
    chairHeadPosition  = {д.\,ф.-м.\,н., профессор},
    chairHead          = {{\sigplace{И.В.~Романовский}{подпись}}},
%   university         = {Санкт-Петербургский Государственный Университет},
%   faculty            = {Математико-механический факультет},
%   city               = {Санкт-Петербург},
%   year               = {2013}
}
\filltitle{en}{
    chair              = {Chair of The Operations Research},
    title              = {Short-time Walsh transform},
    author             = {Grigory Kalabin},
    supervisorPosition = {docent},
    supervisor         = {{\sigplace{S.M.~Masharsky}{signature}}},
    reviewerPosition   = {professor},
    reviewer           = {{\sigplace{V.N.~Malozemov}{signature}}},
    chairHeadPosition  = {professor},
    chairHead          = {{\sigplace{J.V.~Romanovsky}{signature}}},
}
\maketitle
\tableofcontents
\newpage
% У введения нет номера главы
\section*{Введение}
Идея оконного преобразования давно известна~\cite{b-allen} и широко применяется в 
цифровой обработке сигналов. В частности, данный подход активно используется при
реализации эквалайзеров и построении спектрограмм, к примеру, 
специалисты по обработке аудио
используют спектрограммы для выявления частот, соответствующих каким-либо шумам
или для нахождения резонансных частот в помещении, где был записан сигнал, а с 
помощью эквалайзера можно эти частоты выровнять или вообще устранить.

Не всегда возможно работать целиком с исследуемым сигналом. Зачастую сигналы, 
которые необходимо обрабатывать, достаточно длинные. Обычно цифровое аудио имеет
частоту дискретизации 44,1~kHz, а это значит, что каждая секунда такого аудио
представляется 44 100 значениями. Таким образом, аудиофайл длительностью в пару
минут представляется 5~292~000 отсчётами. Если время обработки не так принципиально,
то можно использовать не самые оптимальные алгоритмы и подходы.

Ситуация кардинально меняется, если необходимо изменять аудио во время 
прослушивания. Это означает, что любая задержка, даже в десятую долю секунды,
становится крайне нежелательной. 
Пример подобной ситуации --- работа с эквалайзером, при которой
мы применяем различные фильтры к сигналу и хотим слышать изменения в реальном времени.
Процесс работы с эквалайзером называется \emph{эквализацией} и используется 
практически всегда при записи музыки.

Теперь представим себе ситуацию, что исследуемый сигнал начался неизвестно когда
и неизвестно когда закончится, а обрабатывать его нужно прямо сейчас. Такие ситуации
встречаются достаточно часто, например, при разговоре с удалённым 
собеседником. Помимо нашего голоса, динамики воспринимают большое количество внешних
шумов (таких как проезжающие рядом автомобили, порывы ветра или слова посторонних людей).
Ясно, что задержки при обработке сигнала в этой ситуации также нежелательны, поэтому
требования, предъявляемые к используемым подходам и алгоритмам, весьма высоки.

В этой работе рассматривается идея использования быстрого преобразования 
Уолша при оконной обработке сигнала. Такой подход позволяет не покидать вещественное
пространство при обработке вещественных сигналов, что в некоторой степени упрощает
восприятие информации, связанной со спектром исследуемого сигнала.
Также в ходе написания данной работы, оказалось, что высокие частоты спектра Уолша 
могут быть вырезаны без добавления значительного количество помех, что делает
достаточно перспективным направление сжатия сигналов на основе спектра Уолша.

Для демонстрации рассматриваемой идеи на практике были написаны два 
приложения. Одно из этих приложений --- эквалайзер, использующий
оконное преобразование Уолша для фильтрации сигнала. Другое приложение демонстрирует
возможность сжатия аудио на основе подхода, рассматриваемого в данной работе. 
Обзор этих приложений представлен в разделе~\ref{sec:demo}.

Формальные определения объектов, используемых в работе, описаны в разделе~
\ref{sec:preliminary}.


\section{Предварительные сведения}
\label{sec:preliminary}
В этом разделе представлено математическое описание объектов, используемых в работе.
Формальные определения и обозначения, связанные с сигналами,
заимствованы из книги \cite{dha}.

Носитель функции $f: \, X \rightarrow Y$ --- 
это замыкание подмножества $X$, на котором функция $f$ не обращается в ноль:
$$
 \mathrm{supp}\,f=\overline{\left\{x\mid f(x)\ne 0\right\}}.
$$

Любое число $j \in 0:2^\nu - 1$ можно представить единственным образом в виде
$$
 j = j_{\nu-1} 2^{\nu-1} + j_{\nu-2} 2^{\nu-2} + \ldots + j_1 2 + j_0,
$$
где все коэффициенты $j_k$ равны нулю или единице. Более компактная запись данного
равенства --- $j=(j_{\nu-1}, j_{\nu-2}, \ldots, j_0)_2$.

Введём обозначение  
$$
  \mathrm{rev}_\nu(j) = (j_0, j_1, \ldots, j_{\nu-1})_2.
$$

Зафиксируем натуральное число $N$. \emph{Сигналом} длины $N$ будем называть комплекснозначную 
функцию целочисленного аргумента $x = x(j), \, j \in \mathbb{N}$ с носителем $0:N-1$. 
Множество сигналов обозначим через 
$\mathbb{C}_N$. В $\mathbb{C}_N$ естественным образом вводятся две операции: 
операция сложения двух сигналов и операция умножения сигнала на комплексное число:
$$
y = x_1+x_2 \: \Leftrightarrow \: y(j) = x_1(j) + x_2(j), \: j \in \mathbb{Z};
$$
$$
y = cx \: \Leftrightarrow \: y(j) = cx(j), \: j \in \mathbb{Z}.
$$
В результате $\mathbb{C}_N$ становится линейным комплексным пространством. Нулевым
элементом в $\mathbb{C}_N$ является сигнал $\mathbb{O}$, такой, что
$\mathbb{O}(j) = 0$ при всех $j \in \mathbb{Z}$.

\emph{Потоком данных} будем называть комплекснозначную 
функцию целочисленного аргумента $x = x(j), \, j \in \mathbb{N}$.




\subsection{Дискретные функции Уолша}
Рассмотрим $N = 2^s, \; N_\nu = N/2^\nu, \; \Delta_\nu = 2^{\nu - 1}$.
Пусть 
$k,j \in 0 : \Delta_{\nu+1}-1, \; k=(k_{\nu-1},k_{\nu-2},\ldots,k_0)_2 \, , \: j=(j_{\nu-1},j_{\nu-2},\ldots,j_0)_2$. 
Положим 
$$
\{k,j\}_\nu = \sum_{\alpha=0}^{\nu-1} k_\alpha j_\alpha \; , \quad k,j \in 0: \Delta_{\nu+1} - 1.
$$
Функции 
$$
v_k(j) = (-1)^{{\{k,j\}}_s} \;, \qquad k,j \in 0:N-1
$$ 
называются \emph{дискретными функциями Уолша}. Отметим, что функции Уолша 
принимают только два значения: $+1$ и $-1$.





\subsection{Базисы Уолша-Адамара и Уолша-Пэли}
Поскольку дискретные функции Уолша образуют базис в пространстве сигналов 
$\mathbb{C}_N$ 
(математическое обоснование этого факта можно найти в книге~\cite{dha}), то 
сигнал $x$ можно представить как
$$
x = \sum_{k=0}^{N-1} X(k) v_k.
$$
Базис $v_0, v_1, \ldots, v_{N-1}$ называется \emph{базисом Уолша-Адамара}.

Известно, что частота функции $v_k$ равна $\mathrm{rev}_s(k)$. Обозначим
$\hat{v}_k = v_{\mathrm{rev}_s(k)}$. Поскольку функция $\mathrm{rev}$ является 
перестановкой множества $0:N-1$, то функции $\hat{v}_k$ тоже образуют
ортогональный базис
в пространстве $\mathbb{C}_N$. Этот базис называется \emph{базисом Уолша-Пэли}.
Разложение сигнала $x$ по базису Уолша-Пэли выглядит следующим образом:
$$
  x = \sum_{k=0}^{N-1} X(\mathrm{rev}_s(k)) \hat{v}_k.
$$

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{../images/walsh.png}
    \caption{Дискретные функции Уолша при $N=2^3$}
    \label{pic:функции_Уолша}
\end{figure}
При $N=2^3$ дискретные функции Уолша выглядят, как показано на рис.~\ref{pic:функции_Уолша}.





\subsection{Оконная функция}
\emph{Оконной функцией} называется весовая функция, которая равна нулю вне заданного
интервала. Например, \emph{прямоугольное окно}:
$$
w_{rect}(k) = 
\left\{ \begin{array}{ll}
  1 & \textrm{если} \; L \leq k \leq R  \\
  0 & \textrm{иначе}
\end{array} \right.
$$
где $[L;R]$ --- заданный интервал.

Ещё один пример оконной функции --- \emph{окно Хемминга}, которое задаётся формулой
$$
    w(k) = 0.5\; \left(1 - \cos \left ( \frac{2 \pi k}{N-1} \right) \right) 
$$
В этом примере носитель функции Хемминга --- $[0;N-1]$.





\section{Быстрое преобразование Уолша}
Как уже было сказано, мы хотим минимизировать задержки при обработке 
исходного сигнала.
Вычисление спектра Уолша-Пэли по определению, очевидно, имеет вычислительную 
сложность $O(N^2)$. В данной работе мы будем применять быстрый алгоритм
разложения, использующий $N \log_2 N$ сложений.

Возьмём сигнал $x \in \mathbb{C}_N$. Рекуррентные соотношения для 
последовательного вычисления коэффициентов разложения по базису Уолша
выглядят следующим образом:
\begin{gather}
\begin{split}
\label{fwt}
x_0 (k) &= x(k), \; k \in 0:N-1; \\
x_\nu (l + p \Delta_{\nu + 1}) &= 
\frac{1}{2} [ x_{\nu - 1} (l + 2 p \Delta_\nu) + x_{\nu - 1} (l + (2 p + 1) \Delta_\nu) ], \\
x_\nu (l + \Delta_\nu + p \Delta_{\nu + 1}) &= 
\frac{1}{2} [ x_{\nu - 1} (l + 2 p \Delta_\nu) - x_{\nu - 1} (l + (2 p +1) \Delta_\nu) ], 
\end{split}
\\
p \in 0:N_\nu - 1, \; l \in 0:\Delta_\nu - 1, \; \nu = 1, \ldots, s. \nonumber
\end{gather}
При $\nu = s$ получаем разложение сигнала $x$ по базису Уолша:
\begin{equation}
\label{fwtWalsh}
  x 
  = \sum_{k=0}^{N-1} x_s(k) v_k 
  = \sum_{k=0}^{N-1} x_s(\mathrm{rev}_s(k)) \hat{v}_k.
\end{equation}


Схема~(\ref{fwt}) называется \emph{быстрым преобразованием Уолша, связанным с 
прореживанием по времени}. Эта схема использует только 
сложения в количестве $N\log_2 N$ операций.

Соотношения~(\ref{fwt}) допускают обращение
\begin{gather}
\begin{split}
\label{revfwt}
x_{\nu - 1} (l + 2 p \Delta_\nu) &=
x_\nu (l + p \Delta_{\nu + 1}) + x_\nu (l + \Delta_\nu + p \Delta_{\nu + 1}), \\
x_{\nu - 1} (l + (2 p + 1) \Delta_\nu) &=
x_\nu (l + p \Delta_{\nu + 1}) - x_\nu (l + \Delta_\nu + p \Delta_{\nu + 1}),
\end{split}
\\
p \in 0:N_\nu - 1, \; l \in 0:\Delta_\nu - 1, \; \nu = s, s-1, \ldots, 1. \nonumber
\end{gather}

При этом $x(k) = x_0(k), \; k \in 0: N-1$.

Из формулы~(\ref{fwtWalsh}) видно, что быстрый алгоритм возможно использовать
для разложения сигнала по базису Уолша-Пэли.



\section{Оконное преобразование Уолша}
Далее будет рассмотрено оконное преобразование Уолша. Сначала рассмотрим общую
идею оконного преобразования, а затем дадим формальное определение.




\subsection{Общая идея оконного преобразования}
Допустим, имеется исходный поток данных, который необходимо обработать.
Общая идея оконного преобразования выглядит следующим образом:

\begin{enumerate}
  \item Зафиксируем $N, d \in \mathbb{N}$
  \item Возьмём оконную функцию $w_0$ с носителем $0:N-1$
  \item Определим сигнал $x$, как очередные $N$ отсчётов
    исходного потока данных. Умножим $x$ на $w_0$ покомпонентно. 
    Рассмотрим результат умножения
    на носителе $w_0$ ---  сигнал $x' \in \mathbb{C}_N$
  \item Произведём обработку $x'$ и получим $x'' \in \mathbb{C}_N$
  \item Запишем $x''$ в некоторый буфер
  \item Преобразуем $w_0$ в $w_1$ так, что $\mathrm{supp}\,(w_1) = d:N+d-1$. 
    Повторим шаги 3--4 для $w_1$. Результат запишем в буфер, учитывая смещение $d$
  \item Будем сдвигать носитель очередной оконной функции и 
    повторять шаги 3--6, пока не обработаем весь исходный сигнал. В результате 
    буфер будет содержать результат обработки
\end{enumerate}

Очевидно, что наличие всего потока данных в момент начала обработки
не требуется, поскольку на каждой итерации обработки очередной части потока нас интересуют
только значения потока данных на носителе окна $w$. Таким образом, данный подход позволяет
обрабатывать в реальном времени сигналы, которые неизвестно когда закончатся (например,
человеческую речь).

Также отметим, что допустимо наложение носителей оконных функций. В этом случае
 необходимо <<склеивание>> наложившихся частей. 
 Мы не будем останавливаться подробно на этом вопросе, поскольку 
в этой работе мы будем <<сдвигать>> окно на всю его длину, поэтому вопрос <<склеивания>> 
наложившихся частей для данной работы не актуален.


\subsection{Обработка сигнала}
Для того чтобы использовать спектр Уолша при обработке очередной части потока данных,
необходимо использовать длину окна $N = 2^s, \, s \in \mathbb{N}$. Если последняя
часть потока содержит меньше отсчётов, чем $N$, то можно дополнить её нулями.

Когда длина каждого обрабатываемого <<куска>> $x'$ сигнала представляется в виде
$2^s$, можно использовать дискретное преобразование Уолша для его обработки.
Будем раскладывать $x'$ по базису Уолша-Пэли и получать упорядоченный по частоте
спектр Уолша. К этому спектру мы можем применять различные фильтры для модификации
исходного сигнала. Поскольку преобразование Уолша обратимо, то 
после фильтрации вернёмся к изначальному представлению
сигнала время--амплитуда.

Если исходный сигнал является вещественным (например, аудиофайл), 
то спектр Уолша этого сигнала также будет вещественным. Это позволяет хранить 
в два раза меньше
информации для спектра
по сравнению со спектром Фурье
и упрощает представление графической информации, связанной 
с ним. Примером такой графической информации может являться спектрограмма ---
изображение, показывающее зависимость спектральной плотности мощности сигнала 
от времени. Спектрограммы применяются для идентификации речи, анализа звуков 
животных, в различных областях музыки, радио- и гидролокации, при обработке речи, 
сейсмологии и в других областях.




\subsection{Формальное определение}
Теперь дадим формальное определение оконному преобразованию Уолша. 
По соображениям, приведённым выше, мы будем использовать базис Уолша-Пэли,
однако данное определение может быть легко сформулировано и для базиса 
Уолша-Адамара.

Пусть у нас есть
некоторый поток данных $x$. И прямоугольная оконная функция $w$ с носителем
$0:N-1$.
Оконным преобразованием Уолша потока данных $x$ называется матрица $X$, задаваемая 
следующим равенством:

\[ 
\mathbf{STWT}\{x\}(d,k)\equiv X(d,k) 
= \frac{1}{N} \sum_{j=0}^{N-1} x[j+d]w[j]\hat{v}_k(j),
\quad k \in 0:N-1, \; d \in (-\infty; +\infty).
\]

Индекс $d$ матрицы соответствует точке во времени, а индекс $k$ --- частоте.
Таким образом, данная матрица позволяет по времени и частоте узнать 
магнитуду исходного сигнала.


\subsection{Восстановление исходного сигнала}
Поскольку преобразование Уолша обратимо, то мы
можем перейти от представления частота--магнитуда к представлению
время--амплитуда.

Для каждого оконного спектра $X(d, k)$ вычислим обратное преобразование
Уолша и получим часть исходного потока данных:
\[
x(d,j) = \sum_{k=0}^{N-1} X(d,k) \hat{v}_k(j),
\quad j \in 0:N-1, \; d \in (-\infty; +\infty).
\]

Поскольку в данной работе рассматривается оконное преобразование
с прямоугольным окном, то
можно перейти от матрицы $x(d,j)$ к исходному потоку данных $x(t)$ следующим образом:
\[
 x(t) = \frac{1}{N} \sum_{j=0}^{N-1} x(t-j,j), \quad t \in (-\infty; +\infty).
\]


\section{Результаты}
В рамках данной работы было реализовано оконное преобразование Уолша на языке java
и были проведены различные эксперименты. В качестве исходных данных брались
аудио файлы с записью гитары, пианино, скрипки и человеческой речи. Некоторая информация об
исходных данных указана в таблице~\ref{tab:audio-samples}.

\begin{table}
  \centering
    \begin{tabular}{ | p{2.4cm} | l | p{2cm} | p{2cm} | p{2cm} | p{4.5cm} |}
    \hline
    Название файла & Инструмент & Длитель-ность & Размер, byte & Размер, samples & Примечание \\ \hline
    vivaldi.wav & Скрипка & 15~сек & 2 921 548 & 1 460 752 & Антонио Вивальди, <<Весна>>, часть 1 Аллегро \\ \hline
    chopin.wav & Фортепиано & 13~сек & 1 178 548 & 589 203 & Фридерик Шопен, <<ноктюрн №2>> \\ \hline
    metallica.wav & Гитара & 24~сек & 2 190 902 & 1 095 429 & Группа <<Metallica>>, <<Nothing else matters>> \\ \hline
    voice.wav & Речь & 3~сек & 702 644 & 351 300 & Женская речь \\ \hline
    \end{tabular}
    \caption{Описание тестовых исходных данных}
    \label{tab:audio-samples}
\end{table}

Было установлено, что при помощь оконного преобразования Уолша возможна
достаточно эффективная обработка сигналов.

\subsection{Вырезание частот}
В рамках данной работы был проведён эксперимент в котором из спектра вырезались верхние частоты, то есть
к исходному сигналу применялся простейший низкочастотный фильтр.
При проведении эксперимента использовалось прямоугольное окно без наложений с длиной
равной 1024 отсчётам.
В результате было получено,
что при вырезании $15/16$ верхних частот, то есть обнулении компонент спектра
Уолша-Пэли с индексами от 65 до 1023, результат фильтрации вполне узнаваем.
Можно сделать вывод, что верхние частоты при разложении сигнала по
базису Уолша воспринимаются человеком значительно меньше, чем низкие.
Этот факт можно использовать для реализации сжатия на основе 
оконного преобразования Уолша.

\subsection{Сжатие звука на основе оконного преобразования Уолша}
При написании данной работы были проведены различные эксперименты
по сжатию звука с помощью оконного преобразования Уолша. Сводные результаты
экспериментов приведены в таблице~\ref{tab:compression-ratio}. 
Для сжатия данных использовался алгоритм DEFLATE~\cite{deflate-spec}.
Компрессия применялась не к каждому отдельному окну, а ко всему
сигналу целиком. Это значительно увеличивает эффективность
алгоритма сжатия.

\begin{table}
  \centering
    \begin{tabular}{ | p{2.4cm} | l | l | l | l |}
    \hline
    Файл & Без фильтрации & 1/2 спектра & 1/4 спектра & 1/8 спектра \\ \hline
    vivaldi.wav     & 1.25  & 2.32  & 4.36  & 8.21 \\ \hline
    metallica.wav   & 1.22  & 2.28  & 4.32  & 8.15 \\ \hline
    chopin.wav      & 1.21  & 2.27  & 4.31  & 8.11 \\ \hline
    voice.wav       & 1.21  & 2.26  & 4.27  & 8.10 \\ \hline
    \end{tabular}
    \caption{Коэффициент сжатия при указанной не нулевой части спектра}
    \label{tab:compression-ratio}
\end{table}




\section{Демо приложения}
\label{sec:demo}
В ходе данной работы были реализованы два приложения на языке java
для демонстрации возможностей оконного преобразования.
Весь исходный код программ можно найти по адресу \url{http://bitbucket.org/gkalabin/diploma}.
Данные приложения могут работать с аудио-файлами в формате wav. Чтение и
запись wav файлов реализована по спецификации~\cite{wav-spec}.

Перед данными приложениями не ставилась задача воспроизводить 
потоковое аудио, 
поэтому чтение и запись сигналов происходит целиком, а не частями,
однако вся обработка аудио реализована с помощью оконного преобразования
Уолша. 




\subsection{Эквалайзер}
Первым представленым в данной работе демонстрационным приложением является эквалайзер на основе 
оконного преобразования Уолша. Скриншот данного приложения изображён 
на рисунке~\ref{pic:eq-screenshot}.
\begin{figure}
    \centering
    \includegraphics[width=\textwidth, keepaspectratio=true]{../images/equalizer-screen.png}
    \caption{Эквалайзер на основе оконного преобразования Уолша}
    \label{pic:eq-screenshot}
\end{figure}

В этом приложении возможно регулировать мощность 8 диапазонов частот
исходного сигнала в диапазоне от -10dB до +10dB, а также обнулять тот или иной диапазон.

Также возможен выбор длины окна, которое будет использоваться для 
обработки сигнала, в диапазоне от 128 до 8192 отсчётов.

При нажатии кнопки <<Start>> читается входной файл, производится 
его обработка, в зависимости от указанных параметров фильтрации.
Затем результат записывается в выходной файл. Также имеется возможность
прослушать входной и выходной аудио-файлы.

Детальная информация об обработке сигнала выводится в специальное
поле, которое очищается перед очередным запуском фильтрации.

\subsection{Сжатие аудио}
Другое приложение, написанное в ходе данной работы, позволяет
сжимать аудио файлы на основе оконного преобразования Уолша с использованием
алгоритма сжатия DEFLATE~\cite{deflate-spec}. Скриншот данного приложения
представлен на рисунке~\ref{pic:compressor-screenshot}.
\begin{figure}
    \centering
    \includegraphics[width=\textwidth, keepaspectratio=true]{../images/compressor-screen.png}
    \caption{Приложение, осуществляющее сжатие на основе оконного преобразования Уолша}
    \label{pic:compressor-screenshot}
\end{figure}

Сжатое аудио данным приложением записывается в выходной файл с расширением wal.
В файле wal хранится следующая информация:
\begin{itemize}
 \item Длина окна, при которой данный файл был записан
 \item Длина исходного сигнала, записанного в файле
 \item Коэффициент нормализации для каждого окна
 \item Оконный спектр Уолша-Пэли исходного сигнала
\end{itemize}

Хранение длины исходного сигнала предотвращает удлинение сигнала, 
полученного при кодировании--раскодировании wal файла. Подобное увеличении длины
сигнала
возникает при дополнении последнего окна нулями для использования
преобразования Уолша.

При кодировании данных вычисляется коэффициент нормализации $\alpha_i$
для каждого оконного спектра. Это такое число, что компоненты нормированного 
спектра 
$\alpha_i X(\cdot,i)$ гарантированно попадают в диапазон значений, представимых
при заданном количестве байт на отсчёт. При таком подходе уменьшаются 
погрешности при переходе от вещественных компонент спектра к 
байтам, хранимым в wal файле. По нажатии кнопки <<Start>>
читается исходный файл, считается его оконный спектр Уолша и нормализуется. 
Затем этот спектр и нормализующий коэффициент 
записываются в wal файл.
  
При декодировании, читается wal файл, затем читаются оконные спектры
$X(\cdot,i)$,
их коэффициенты нормализации $\alpha_i$ и вычисляется исходный оконный спектр
$\frac{1}{\alpha_i} X(\cdot,i)$, производится обратное 
преобразование Уолша
по быстрому алгоритму~(\ref{revfwt}). Результат записывается в 
выходной wav файл.

При сжатии файла возможно выбрать длину окна, которая будет использована
при оконном преобразовании Уолша. При декодировании wal файла выбор длины окна
недопустим, поскольку длина окна хранится в wal файле.

Сообщения о результате работы программы выводятся в специальное поле.





% У заключения нет номера главы
\section*{Заключение}
В ходе данной дипломной работы была рассмотрена идея совмещения
дискретного преобразования Уолша и оконного преобразования. Рассматриваемая 
идея оказалась достаточно перспективной в различных направлениях, таких как
сжатие и обработка сигналов. 

Одно из преимуществ использования дискретного преобразования Уолша
по сравнению с дискретным преобразованием Фурье состоит в том, что
первое не выводит нас за пределы исходного пространства, то есть, если
наш исходный сигнал был вещественный, то после обработки его с помощью
дискретного преобразования Уолша, результат также будет вещественным.
Это может значительно облегчить представление информации, используемой при
работе с цифровыми сигналами. Подобное представление упростит выявление
<<нежелательных>> частоты и различных шумов в исследуемом сигнале.

Ещё одним преимуществом оконного преобразования Уолша является 
возможность обработки сигнала без ожидания окончания ввода данных.
Примеров таких ситуаций достаточно много, но, пожалуй, самый
распространённый --- различные средства связи, в которых применяется
шумо- и эхоподавление. Различная фильтрация и оптимизация сигналов
позволяет экономить на размерах каналов передачи данных, а также улучшает
восприятие звука.

В процессе написания данной работы было обнаружено, что можно достаточно 
эффективно сжимать звуковые сигналы с помощью оконного преобразования Уолша.
Для демонстрации этого факта было написано соответствующее приложение.

Для хранения сжатых аудиофайлов был написан собственный аудиокодек,
который может записывать оконный спектр Уолша в файл, а также
читать ранее записанный спектр из файла. Такие файлы записываются
с расширением \emph{wal} --- сокращённое от Walsh (Уолш).

Все цели поставленные перед написанием данной работы были достигнуты,
перспективность рассматриваемого подхода продемонстрирована, поэтому
можно считать, что исследование оконного преобразования Уолша завершено 
в рамках данной работы.



\bibliographystyle{ugost2008}
\nocite{*}
\bibliography{diploma.bib}

\begin{appendices}
\section{Исходный код программы}
    \input{appendix/fwt.tex}
    \input{appendix/walsh.tex}
    \input{appendix/window.tex}
    \input{appendix/samples_wrappers.tex}
    \input{appendix/filtering.tex}
    \input{appendix/io.tex}
\end{appendices}
\end{document}